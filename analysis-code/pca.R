library(bio3d)
traj <- read.ncdf("nowatr.nc")
pdb <- read.pdb("comp.pdb")
ca.inds <- atom.select(pdb, elety="CA")
xyz <- fit.xyz(fixed=pdb$xyz, mobile=traj, fixed.inds=ca.inds$xyz, mobile.inds=ca.inds$xyz)
dim(xyz) == dim(traj)
pc <- pca.xyz(xyz[,ca.inds$xyz])
png("6xi7_pca.png")
plot(pc,col=bwr.colors(nrow(xyz)))
dev.off()
hc <- hclust(dist(pc$z[,1:2]))
grps1 <- cutree(hc, k=4)
png("6xi7_clust4.png")
plot(pc, col=grps1)
dev.off()
grps2 <- cutree(hc, k=2)
png("6xi7_clust3.png")
plot(pc, col=grps1)
dev.off()
pc1 <- mktrj.pca(pc, pc=1, b=pc$au[,1], file="pc1.pdb")
pc2 <- mktrj.pca(pc, pc=2, b=pc$au[,2], file="pc2.pdb")
write.ncdf(pc1, "trj_1.nc")
write.ncdf(pc2, "trj_2.nc")
cij <- dccm(xyz[,ca.inds$xyz])
png("6xi7_corr.png")
plot(cij)
dev.off()
pymol.dccm(cij,pdb,type="launch")

