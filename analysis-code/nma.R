library(bio3d)
library(igraph)
pdb <- read.pdb("7jvz.pdb")
modes <- nma(pdb)
png("jvz_mode.png")
plot(modes)
dev.off()
mktrj(modes, mode=7)
pymol(modes, mode=7)
cm <- dccm(modes)
png("7jvz_corr.png")
plot(cm, contour=F, col.regions=bwr.colors(20))
dev.off()
pymol(cm, pdb, type="launch")
defe <- deformation.nma(modes)
defsums <- rowSums(defe$ei[,1:3])
flucts <- fluct.nma(modes, mode.inds=seq(7,9))
write.pdb(pdb=NULL, xyz=modes$xyz, file="7jvz_deform.pdb",b=defsums)
write.pdb(pdb=NULL, xyz=modes$xyz, file="7jvz_fluct.pdb", b=flucts)


